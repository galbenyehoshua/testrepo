# Define the path to the CSV file and the template XML file
$csvPath = "C:\path\to\employees.csv"
$templatePath = "C:\path\to\template.xml"
$outputFolder = "C:\path\to\output\files"

# Import the CSV file containing employee data
$employees = Import-Csv -Path $csvPath

# Ensure output directory exists
if (-not (Test-Path -Path $outputFolder)) {
    New-Item -Path $outputFolder -ItemType Directory
}

# Read the template XML file
$templateContent = Get-Content -Path $templatePath -Raw

# Loop through each employee and generate the XML file
foreach ($employee in $employees) {
    # Replace placeholders in the template with actual values
    $modifiedContent = $templateContent -replace "{{Username}}", $employee.Username `
                                            -replace "{{FirstName}}", $employee.FirstName `
                                            -replace "{{LastName}}", $employee.LastName `
                                            -replace "{{Extension}}", $employee.Extension

    # Define the filename based on the Username
    $filePath = Join-Path -Path $outputFolder -ChildPath "$($employee.Username).xml"
    
    # Write the modified XML content to the file
    $modifiedContent | Out-File -FilePath $filePath -Encoding UTF8
    Write-Host "Generated XML for $($employee.Username) at $filePath"
}
