# Input CSV file path
$inputFile = "C:\path\to\your\inputfile.csv"

# Output CSV file path
$outputFile = "C:\path\to\your\outputfile.csv"

# Import data from input CSV
$inputData = Import-Csv -Path $inputFile

# Prepare an array to store output data
$outputData = @()

# Loop through each row in the input data
foreach ($user in $inputData) {
    # Create a username by combining first name and last name (lowercased or any other format as needed)
    $userName = ($user.FirstName.Substring(0,1) + $user.LastName).ToLower()

    # If you have a specific rule for extensions, modify this part. For example, assigning a default value or a custom logic.
    # This example uses a fixed extension for simplicity.
    $extension = "1234"  # This can be dynamically assigned if needed

    # Add the new user data to the output array
    $outputData += [PSCustomObject]@{
        UserName = $userName
        FirstName = $user.FirstName
        LastName = $user.LastName
        Extension = $extension
    }
}

# Export the output data to a new CSV file
$outputData | Export-Csv -Path $outputFile -NoTypeInformation

Write-Host "Processing complete. Output saved to $outputFile"
