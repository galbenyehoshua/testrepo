# Define the folder path where the XML files are located
$folderPath = "C:\path\to\your\folder"  # Update with your folder path

# Get all XML files in the specified folder
$xmlFiles = Get-ChildItem -Path $folderPath -Filter "*.xml"

# Create an empty XML structure with the <tns:users> root element
$mergedXml = New-Object System.Xml.XmlDocument
$mergedXml.LoadXml("<tns:users xmlns:tns='http://example.com/ns'></tns:users>")  # Adjust namespace if necessary

# Loop through each XML file and merge the user nodes
foreach ($file in $xmlFiles) {
    $xml = [xml](Get-Content -Path $file.FullName)
    
    # Select the <tns:user> nodes from the current file
    $usersNode = $xml.DocumentElement.GetElementsByTagName("tns:user")
    
    foreach ($userNode in $usersNode) {
        # Import the <tns:user> node into the merged XML document
        $importedNode = $mergedXml.ImportNode($userNode, $true)
        
        # Append the imported <tns:user> node to the <tns:users> root
        $mergedXml.DocumentElement.AppendChild($importedNode)
    }
}

# Save the merged XML to a new file
$mergedXml.Save("C:\path\to\your\folder\merged.xml")  # Change this to your desired output file path
