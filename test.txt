# Define the path to your CSV file and the target security group name
$csvPath = "C:\path\to\users.csv"
$securityGroup = "SecurityGroupName"

# Import the CSV file containing the list of usernames
$users = Import-Csv $csvPath

# Loop through each user in the CSV
foreach ($user in $users) {
    # Get the user object from AD and check if they're a member of the specified group
    $adUser = Get-ADUser -Identity $user.Username -Properties MemberOf
    $isMember = $adUser.MemberOf -contains "CN=$securityGroup,"

    # Output whether the user is a member or not
    if ($isMember) {
        Write-Host "$($user.Username) is a member of the group."
    } else {
        Write-Host "$($user.Username) is NOT a member of the group."
    }
}
